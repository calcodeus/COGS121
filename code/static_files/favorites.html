<html>

<head>
  <title>Anime Noobs</title>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">
  <link rel="stylesheet" href="css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="css/bootstrap.min.css">


  <script src="js/bootstrap.min.js"></script>
  <script src="jquery-3.3.1.min.js"></script>
  <script type="text/javascript">
    // jQuery convention for running when the document has been fully loaded:
    $(document).ready(() => {
        $('#searchButton').click(() => {
          const requestURL = 'find/' + $('#nameBox').val();
          console.log('making ajax request to:', requestURL);

          $.ajax({
                // all URLs are relative to http://localhost:3000/
                url: requestURL,
                type: 'GET',
                dataType : 'json', // this URL returns data in JSON format
                success: (data) => {
                  console.log("response received: " + data);
                  if (data[0]) {
                    let resList = Object.keys(data).map((k) => { return data[k] });
                    console.log(resList);
                    resList.sort((a, b)=>{
                      return b.popularity - a.popularity;
                    });
                    let resultDiv = document.getElementById('favDiv');
                    resultDiv.insertAdjacentHTML('beforeend', resList[0].title + '<br>');
                    console.log(resList);

                  } else {
                    console.log("no results found");
                  }
                },
              });

        });      $('#next').click(() => {
        window.location = "results.html"
      });

      // define a generic Ajax error handler:
      // http://api.jquery.com/ajaxerror/
      $(document).ajaxError(() => {
        $('#status').html('Error: unknown ajaxError!');
      });
    });
  </script>
</head>

<body>
  <h1>Enter your favorite movies and show</h1>

  <input id="nameBox" type="text" size="20" />
  <button id="searchButton"><i class="fas fa-plus"></i></button>
  <button id="next">next</button>
  <div id="favDiv"></div>
  <img id="petImage"></img>
  <div id="box">
    <div id="text"></div>
  </div>

  <hr/>

  <div id="status"></div>
</body>

</html>
